{"ast":null,"code":"import _classCallCheck from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/maksimzajcev/Desktop/Work/src/components/React.mode.js\";\nimport React from 'react';\nimport dataLoad from '../models/dataLoad';\nimport Navigation from './React.nav';\nimport Loader from './React.loader';\nimport moment from 'moment';\nimport MonthWorkspace from './React.month.workspace';\nimport '../css/main.css';\n\nvar Month =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(Month, _React$Component);\n\n  function Month(props) {\n    var _this;\n\n    _classCallCheck(this, Month);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Month).call(this, props));\n    _this.state = {\n      charts: {},\n      defaultChart: [],\n      strainData: [],\n      startDate: '',\n      finishDate: '',\n      loading: false\n    };\n    return _this;\n  }\n\n  _createClass(Month, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.loadData();\n    }\n  }, {\n    key: \"loadData\",\n    value: function loadData() {\n      var _this2 = this;\n\n      var urlVisits = 'http://localhost:3000/visits';\n      dataLoad(urlVisits).then(function (visits) {\n        visits = JSON.parse(visits);\n\n        var goodBegin = _this2.getGoodBeginData(visits);\n\n        var bedBegin = _this2.getBedBeginData(visits);\n\n        var goodEnd = _this2.getGoodEndData(visits);\n\n        var bedEnd = _this2.getBedEndData(visits);\n\n        var defaultChart = _this2.getDefaultChart();\n\n        var charts = {\n          goodBegin: {\n            chartId: 4501,\n            data: goodBegin,\n            display: true,\n            color: '#84c9f6'\n          },\n          bedBegin: {\n            chartId: 4502,\n            data: bedBegin,\n            display: true,\n            color: '#3fa6e9'\n          },\n          goodEnd: {\n            chartId: 4503,\n            data: goodEnd,\n            display: true,\n            color: '#127bbf'\n          },\n          bedEnd: {\n            chartId: 4504,\n            data: bedEnd,\n            display: true,\n            color: '#3fa6e9'\n          }\n        };\n        var finishDate = moment(new Date(), 'DD.MM').subtract(1, \"days\");\n        var startDate = moment(new Date(), 'DD.MM').subtract(30, \"days\");\n        var strainData = [];\n\n        for (var i = 0; i < 30; i++) {\n          var dayData = {\n            date: charts.users.data[i].x,\n            users: charts.users.data[i].y,\n            visits: charts.visits.data[i].y,\n            views: charts.views.data[i].y\n          };\n          strainData.push(dayData);\n        }\n\n        _this2.setState({\n          charts: charts,\n          defaultChart: defaultChart,\n          strainData: strainData,\n          startDate: startDate.format('DD.MM'),\n          finishDate: finishDate.format('DD.MM'),\n          loading: true\n        });\n      }).catch(function (logs) {\n        console.log('error ' + logs);\n      });\n    }\n  }, {\n    key: \"getGoodBeginData\",\n    value: function getGoodBeginData(visits) {\n      var currentlyDate = moment(new Date(), 'DD.MM');\n      var startDate = currentlyDate.subtract(30, \"days\");\n      var sortVisits = [];\n\n      for (var i = 30; i > 0; i--) {\n        var visitsOnDay = 0;\n\n        for (var j = 0; j < userLogs.length; j++) {\n          if (userLogs[j].time.slice(0, 5) === startDate.format('DD.MM')) {\n            visitsOnDay++;\n          }\n        }\n\n        var oneDayValue = {\n          x: startDate.format('DD.MM'),\n          y: visitsOnDay\n        };\n        startDate = startDate.add(1, \"days\");\n        sortVisits.push(oneDayValue);\n      }\n\n      return sortVisits;\n    }\n  }, {\n    key: \"getBedBeginData\",\n    value: function getBedBeginData(userLogs) {\n      var currentlyDate = moment(new Date(), 'DD.MM');\n      var startDate = currentlyDate.subtract(30, \"days\");\n      var sortViews = [];\n\n      for (var i = 30; i > 0; i--) {\n        var viewsOnDay = 0;\n\n        for (var j = 0; j < userLogs.length; j++) {\n          if (userLogs[j].time.slice(0, 5) === startDate.format('DD.MM')) {\n            viewsOnDay = viewsOnDay + userLogs[j].pages;\n          }\n        }\n\n        var oneDayValue = {\n          x: startDate.format('DD.MM'),\n          y: viewsOnDay\n        };\n        startDate = startDate.add(1, \"days\");\n        sortViews.push(oneDayValue);\n      }\n\n      return sortViews;\n    }\n  }, {\n    key: \"getGoodEndData\",\n    value: function getGoodEndData(userLogs) {\n      var currentlyDate = moment(new Date(), 'DD.MM');\n      var startDate = currentlyDate.subtract(30, \"days\");\n      var sortUsers = [];\n\n      for (var i = 30; i > 0; i--) {\n        var uniqueUsers = [];\n\n        for (var j = 0; j < userLogs.length; j++) {\n          if (userLogs[j].time.slice(0, 5) === startDate.format('DD.MM') && !uniqueUsers.includes(userLogs[j].userId)) {\n            uniqueUsers.push(userLogs[j].userId);\n          }\n        }\n\n        var oneDay = {\n          x: startDate.format('DD.MM'),\n          y: uniqueUsers.length\n        };\n        startDate = startDate.add(1, \"days\");\n        sortUsers.push(oneDay);\n      }\n\n      return sortUsers;\n    }\n  }, {\n    key: \"getBedEndData\",\n    value: function getBedEndData(userLogs) {\n      var currentlyDate = moment(new Date(), 'DD.MM');\n      var startDate = currentlyDate.subtract(30, \"days\");\n      var sortUsers = [];\n\n      for (var i = 30; i > 0; i--) {\n        var uniqueUsers = [];\n\n        for (var j = 0; j < userLogs.length; j++) {\n          if (userLogs[j].time.slice(0, 5) === startDate.format('DD.MM') && !uniqueUsers.includes(userLogs[j].userId)) {\n            uniqueUsers.push(userLogs[j].userId);\n          }\n        }\n\n        var oneDay = {\n          x: startDate.format('DD.MM'),\n          y: uniqueUsers.length\n        };\n        startDate = startDate.add(1, \"days\");\n        sortUsers.push(oneDay);\n      }\n\n      return sortUsers;\n    }\n  }, {\n    key: \"getDefaultChart\",\n    value: function getDefaultChart() {\n      var currentlyDate = moment(new Date(), 'DD.MM');\n      var startDate = currentlyDate.subtract(30, \"days\");\n      var defaultDays = [];\n\n      for (var i = 30; i > 0; i--) {\n        var oneDay = {\n          x: startDate.format('DD.MM'),\n          y: 0\n        };\n        startDate = startDate.add(1, \"days\");\n        defaultDays.push(oneDay);\n      }\n\n      return defaultDays;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      console.log(\" * * * КОРЕНЬ * * * \");\n      console.log(this.state.charts);\n      return React.createElement(\"div\", {\n        id: \"maskComponent\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }, !this.state.loading ? React.createElement(Loader, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }) : null, React.createElement(\"div\", {\n        className: \"sidebar\",\n        id: \"sidebar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223\n        },\n        __self: this\n      }, React.createElement(Navigation, {\n        activeItem: 7717,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"panel\",\n        id: \"panel\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }, React.createElement(MonthWorkspace, {\n        charts: this.state.charts,\n        defaultChart: this.state.defaultChart,\n        strainData: this.state.strainData,\n        startDate: this.state.startDate,\n        finishDate: this.state.finishDate,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 227\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return Month;\n}(React.Component);\n\nexport default Month;","map":{"version":3,"sources":["/Users/maksimzajcev/Desktop/Work/src/components/React.mode.js"],"names":["React","dataLoad","Navigation","Loader","moment","MonthWorkspace","Month","props","state","charts","defaultChart","strainData","startDate","finishDate","loading","loadData","urlVisits","then","visits","JSON","parse","goodBegin","getGoodBeginData","bedBegin","getBedBeginData","goodEnd","getGoodEndData","bedEnd","getBedEndData","getDefaultChart","chartId","data","display","color","Date","subtract","i","dayData","date","users","x","y","views","push","setState","format","catch","logs","console","log","currentlyDate","sortVisits","visitsOnDay","j","userLogs","length","time","slice","oneDayValue","add","sortViews","viewsOnDay","pages","sortUsers","uniqueUsers","includes","userId","oneDay","defaultDays","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport dataLoad from '../models/dataLoad';\nimport Navigation from './React.nav';\nimport Loader from './React.loader';\nimport moment from 'moment'\nimport MonthWorkspace from './React.month.workspace';\nimport '../css/main.css';\n\nclass Month extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            charts: {},\n            defaultChart: [],\n            strainData: [],\n            startDate: '',\n            finishDate: '',\n            loading: false\n        };\n    }\n\n    componentDidMount() {\n        this.loadData();\n    }\n\n    loadData() {\n        var urlVisits = 'http://localhost:3000/visits';\n\n        dataLoad(urlVisits).then(visits => {\n            visits = JSON.parse(visits);\n            \n            var goodBegin = this.getGoodBeginData(visits);\n            var bedBegin = this.getBedBeginData(visits);\n            var goodEnd = this.getGoodEndData(visits);\n            var bedEnd = this.getBedEndData(visits);\n\n            var defaultChart = this.getDefaultChart();\n\n            var charts = {\n                goodBegin: {\n                    chartId: 4501,\n                    data: goodBegin,\n                    display: true,\n                    color: '#84c9f6'\n                },\n                bedBegin: {\n                    chartId: 4502,\n                    data: bedBegin,\n                    display: true,\n                    color: '#3fa6e9'\n                },\n                goodEnd: {\n                    chartId: 4503,\n                    data: goodEnd,\n                    display: true,\n                    color: '#127bbf'\n                },\n                bedEnd: {\n                    chartId: 4504,\n                    data: bedEnd,\n                    display: true,\n                    color: '#3fa6e9'\n                }\n            };\n\n            var finishDate = moment(new Date(), 'DD.MM').subtract(1, \"days\");\n            var startDate = moment(new Date(), 'DD.MM').subtract(30, \"days\");\n\n            var strainData = [];\n\n            for (let i = 0; i < 30; i++) {\n                var dayData = {\n                    date: charts.users.data[i].x,\n                    users: charts.users.data[i].y,\n                    visits: charts.visits.data[i].y,\n                    views: charts.views.data[i].y,\n                }\n\n                strainData.push(dayData);\n            }\n\n            this.setState({\n                charts: charts,\n                defaultChart: defaultChart,\n                strainData: strainData,\n                startDate: startDate.format('DD.MM'),\n                finishDate: finishDate.format('DD.MM'),\n                loading: true\n            });\n\n        }).catch(function(logs) {\n            console.log('error ' + logs);\n        })\n    }\n\n    getGoodBeginData(visits) {\n        var currentlyDate = moment(new Date(), 'DD.MM');\n        var startDate = currentlyDate.subtract(30, \"days\");\n        var sortVisits = [];\n\n        for (let i = 30; i > 0; i--) {\n            var visitsOnDay = 0;\n            for (let j = 0; j < userLogs.length; j++) {\n                if (userLogs[j].time.slice(0, 5) === startDate.format('DD.MM')) {\n                    visitsOnDay++;\n                }\n            }\n\n            var oneDayValue = {\n                x: startDate.format('DD.MM'),\n                y: visitsOnDay\n            };\n\n            startDate = startDate.add(1, \"days\");\n            sortVisits.push(oneDayValue);\n        }\n\n        return sortVisits;\n    }\n\n    getBedBeginData(userLogs) {\n        var currentlyDate = moment(new Date(), 'DD.MM');\n        var startDate = currentlyDate.subtract(30, \"days\");\n        var sortViews = [];\n\n        for (let i = 30; i > 0; i--) {\n            var viewsOnDay = 0;\n            for (let j = 0; j < userLogs.length; j++) {\n                if (userLogs[j].time.slice(0, 5) === startDate.format('DD.MM')) {\n                    viewsOnDay = viewsOnDay + userLogs[j].pages;\n                }\n            }\n\n            var oneDayValue = {\n                x: startDate.format('DD.MM'),\n                y: viewsOnDay\n            };\n\n            startDate = startDate.add(1, \"days\");\n            sortViews.push(oneDayValue);\n        }\n\n        return sortViews;\n    }\n\n    getGoodEndData(userLogs) {\n        var currentlyDate = moment(new Date(), 'DD.MM');\n        var startDate = currentlyDate.subtract(30, \"days\");\n        var sortUsers = [];\n\n        for (let i = 30; i > 0; i--) {\n            var uniqueUsers = [];\n            \n            for (let j = 0; j < userLogs.length; j++) {\n                if ((userLogs[j].time.slice(0, 5) === startDate.format('DD.MM')) && (!uniqueUsers.includes(userLogs[j].userId))){\n                    uniqueUsers.push(userLogs[j].userId);\n                }\n            }\n\n            var oneDay = {\n                x: startDate.format('DD.MM'),\n                y: uniqueUsers.length\n            };\n\n            startDate = startDate.add(1, \"days\");\n            sortUsers.push(oneDay);\n        }\n\n        return sortUsers;\n    }\n\n    getBedEndData(userLogs) {\n        var currentlyDate = moment(new Date(), 'DD.MM');\n        var startDate = currentlyDate.subtract(30, \"days\");\n        var sortUsers = [];\n\n        for (let i = 30; i > 0; i--) {\n            var uniqueUsers = [];\n            \n            for (let j = 0; j < userLogs.length; j++) {\n                if ((userLogs[j].time.slice(0, 5) === startDate.format('DD.MM')) && (!uniqueUsers.includes(userLogs[j].userId))){\n                    uniqueUsers.push(userLogs[j].userId);\n                }\n            }\n\n            var oneDay = {\n                x: startDate.format('DD.MM'),\n                y: uniqueUsers.length\n            };\n\n            startDate = startDate.add(1, \"days\");\n            sortUsers.push(oneDay);\n        }\n\n        return sortUsers;\n    }\n\n    getDefaultChart() {\n        var currentlyDate = moment(new Date(), 'DD.MM');\n        var startDate = currentlyDate.subtract(30, \"days\");\n        var defaultDays = [];\n\n        for (let i = 30; i > 0; i--) {\n\n            var oneDay = {\n                x: startDate.format('DD.MM'),\n                y: 0\n            };\n\n            startDate = startDate.add(1, \"days\");\n            defaultDays.push(oneDay);\n        }\n\n        return defaultDays;\n    }\n\n    render() {\n        console.log(\" * * * КОРЕНЬ * * * \");\n        console.log(this.state.charts);\n        return (\n            <div id=\"maskComponent\">\n                {!this.state.loading ? <Loader /> : null}\n                <div className=\"sidebar\" id=\"sidebar\">\n                    <Navigation activeItem={7717} />\n                </div>\n                <div className=\"panel\" id=\"panel\">\n                    <MonthWorkspace\n                        charts={this.state.charts}\n                        defaultChart={this.state.defaultChart}\n                        strainData={this.state.strainData}\n                        startDate={this.state.startDate}\n                        finishDate={this.state.finishDate}\n                    />\n                </div>                        \n            </div>\n        );\n    }\n}\n\nexport default Month;\n\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import _classCallCheck from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/maksimzajcev/Desktop/Work/src/components/React.logs.workspace.js\";\nimport React from 'react';\nimport moment from 'moment';\nimport LogsTable from './React.logs.table';\nimport AddLogs from './React.logs.add';\nimport Userbar from './React.userbar';\nimport dataLoad from '../models/dataLoad';\nimport dataAdd from '../models/dataAdd';\nimport dataDelete from '../models/dataDelete';\nimport dataUpdate from '../models/dataUpdate';\nimport FindLogs from './React.logs.find';\nimport Loader from './React.loader';\nimport '../css/main.css';\nvar urlLogs = 'http://localhost:3000/logs';\nvar urlUsers = 'http://localhost:3000/users';\n\nvar LogsWorkspace =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(LogsWorkspace, _React$Component);\n\n  function LogsWorkspace(props) {\n    var _this;\n\n    _classCallCheck(this, LogsWorkspace);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(LogsWorkspace).call(this, props));\n\n    _this.findRows = function (foundRows) {\n      _this.setState({\n        changedRows: foundRows\n      });\n    };\n\n    _this.addRow = function (newLogsData) {\n      var allLogsData = _this.state.rows;\n      allLogsData.push(newLogsData);\n      dataAdd(urlLogs, newLogsData).then(function (logs) {\n        _this.setState({\n          rows: allLogsData,\n          changedRows: allLogsData\n        });\n      }).catch(function (logs) {\n        console.log('error ' + logs);\n      });\n    };\n\n    _this.removeRow = function (i) {\n      var allLogsData = _this.state.rows;\n      var deleteId = allLogsData[i].id;\n      allLogsData.splice(i, 1);\n      dataDelete(urlLogs, deleteId).then(function (logs) {\n        _this.setState({\n          rows: allLogsData,\n          changedRows: allLogsData\n        });\n      }).catch(function (logs) {\n        console.log('error ' + logs);\n      });\n    };\n\n    _this.updateRow = function (id, userId, time, date, name, company, pages, long, logItems) {\n      var allLogsData = _this.state.rows;\n      var updateLogData = {\n        id: id,\n        userId: userId,\n        time: time,\n        date: date,\n        period: date.slice(3, 10),\n        name: name,\n        company: company,\n        pages: pages,\n        long: long,\n        logItems: logItems\n      };\n\n      for (var i = 0; i < allLogsData.length; i++) {\n        if (allLogsData[i].id === id) {\n          allLogsData[i] = updateLogData;\n        }\n      }\n\n      dataUpdate(urlLogs, updateLogData, updateLogData.id).then(function (logs) {\n        _this.setState({\n          rows: allLogsData,\n          changedRows: allLogsData\n        });\n      }).catch(function (logs) {\n        console.log('error ' + logs);\n      });\n    };\n\n    _this.setPeriod = _this.setPeriod.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.state = {\n      rows: [],\n      changedRows: [],\n      users: [],\n      loading: false,\n      settingPeriod: moment(new Date()).format('MM.YYYY')\n    };\n    return _this;\n  }\n\n  _createClass(LogsWorkspace, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.loadData(this.state.settingPeriod);\n    }\n  }, {\n    key: \"loadData\",\n    value: function loadData(period) {\n      var _this2 = this;\n\n      fetch(urlLogs + '?period=' + period).then(function (responseLogs) {\n        console.log(responseLogs);\n        return responseLogs.json();\n      }).then(function (resultLogs) {\n        fetch(urlUsers).then(function (responseUsers) {\n          console.log(responseUsers);\n          return responseUsers.json();\n        }).then(function (resultUsers) {\n          return _this2.parseData(resultUsers, resultLogs, period);\n        }).catch(function (e) {\n          return console.log(e);\n        });\n      }).catch(function (e) {\n        return console.log(e);\n      });\n    }\n  }, {\n    key: \"parseData\",\n    value: function parseData(users, logs, period) {\n      this.setState({\n        rows: logs,\n        changedRows: logs,\n        users: users,\n        settingPeriod: period,\n        loading: true\n      });\n    }\n  }, {\n    key: \"setPeriod\",\n    value: function setPeriod(event) {\n      this.setState({\n        loading: false\n      });\n      var newPeriod = event.target.value;\n      this.loadData(newPeriod);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"logs\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, !this.state.loading ? React.createElement(Loader, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144\n        },\n        __self: this\n      }) : null, React.createElement(Userbar, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145\n        },\n        __self: this\n      }, React.createElement(FindLogs, {\n        presentRows: this.state.rows,\n        find: this.findRows,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146\n        },\n        __self: this\n      }), React.createElement(\"select\", {\n        className: \"userbar__period\",\n        onChange: this.setPeriod,\n        defaultValue: this.state.settingPeriod,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147\n        },\n        __self: this\n      }, React.createElement(\"option\", {\n        value: \"11.2019\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, \"\\u041D\\u043E\\u044F\\u0431\\u0440\\u044C 2019\"), React.createElement(\"option\", {\n        value: \"10.2019\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, \"\\u041E\\u043A\\u0442\\u044F\\u0431\\u0440\\u044C 2019\"), React.createElement(\"option\", {\n        value: \"09.2019\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      }, \"\\u0421\\u0435\\u043D\\u0442\\u044F\\u0431\\u0440\\u044C 2019\"), React.createElement(\"option\", {\n        value: \"08.2019\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151\n        },\n        __self: this\n      }, \"\\u0410\\u0432\\u0433\\u0443\\u0441\\u0442 2019\"), React.createElement(\"option\", {\n        value: \"07.2019\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, \"\\u0418\\u044E\\u043B\\u044C 2019\"), React.createElement(\"option\", {\n        value: \"06.2019\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      }, \"\\u0418\\u044E\\u043D\\u044C 2019\"), React.createElement(\"option\", {\n        value: \"05.2019\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154\n        },\n        __self: this\n      }, \"\\u041C\\u0430\\u0439 2019\"), React.createElement(\"option\", {\n        value: \"04.2019\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, \"\\u0410\\u043F\\u0440\\u0435\\u043B\\u044C 2019\"), React.createElement(\"option\", {\n        value: \"03.2019\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156\n        },\n        __self: this\n      }, \"\\u041C\\u0430\\u0440\\u0442 2019\"), React.createElement(\"option\", {\n        value: \"02.2019\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, \"\\u0424\\u0435\\u0432\\u0440\\u0430\\u043B\\u044C 2019\"), React.createElement(\"option\", {\n        value: \"01.2019\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, \"\\u042F\\u043D\\u0432\\u0430\\u0440\\u044C 2019\"), React.createElement(\"option\", {\n        value: \"12.2018\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      }, \"\\u0414\\u0435\\u043A\\u0430\\u0431\\u0440\\u044C 2018\"), React.createElement(\"option\", {\n        value: \"11.2018\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }, \"\\u041D\\u043E\\u044F\\u0431\\u0440\\u044C 2018\"))), React.createElement(\"div\", {\n        className: \"logs__addbar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        className: \"logs__title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 164\n        },\n        __self: this\n      }, \"\\u041F\\u0430\\u043D\\u0435\\u043B\\u044C \\u0443\\u043F\\u0440\\u0430\\u0432\\u043B\\u0435\\u043D\\u0438\\u044F \\u043F\\u043E\\u0441\\u0435\\u0449\\u0435\\u043D\\u0438\\u044F\\u043C\\u0438 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u0435\\u0439\"), React.createElement(AddLogs, {\n        add: this.addRow,\n        currentLogs: this.state.rows,\n        users: this.state.users,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 165\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"logs__data\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 167\n        },\n        __self: this\n      }, React.createElement(\"h2\", {\n        className: \"logs__title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168\n        },\n        __self: this\n      }, \"\\u0422\\u0430\\u0431\\u043B\\u0438\\u0446\\u0430 \\u043F\\u043E\\u0441\\u0435\\u0449\\u0435\\u043D\\u0438\\u0439 \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u0435\\u0439\"), React.createElement(LogsTable, {\n        rows: this.state.changedRows,\n        removeRow: this.removeRow,\n        updateRow: this.updateRow,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return LogsWorkspace;\n}(React.Component);\n\nexport default LogsWorkspace;","map":{"version":3,"sources":["/Users/maksimzajcev/Desktop/Work/src/components/React.logs.workspace.js"],"names":["React","moment","LogsTable","AddLogs","Userbar","dataLoad","dataAdd","dataDelete","dataUpdate","FindLogs","Loader","urlLogs","urlUsers","LogsWorkspace","props","findRows","foundRows","setState","changedRows","addRow","newLogsData","allLogsData","state","rows","push","then","logs","catch","console","log","removeRow","i","deleteId","id","splice","updateRow","userId","time","date","name","company","pages","long","logItems","updateLogData","period","slice","length","setPeriod","bind","users","loading","settingPeriod","Date","format","loadData","fetch","responseLogs","json","resultLogs","responseUsers","resultUsers","parseData","e","event","newPeriod","target","value","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport moment from 'moment';\nimport LogsTable from './React.logs.table';\nimport AddLogs from './React.logs.add';\n\nimport Userbar from './React.userbar';\nimport dataLoad from '../models/dataLoad';\nimport dataAdd from '../models/dataAdd';\nimport dataDelete from '../models/dataDelete';\nimport dataUpdate from '../models/dataUpdate';\nimport FindLogs from './React.logs.find';\nimport Loader from './React.loader';\nimport '../css/main.css';\n\nconst urlLogs = 'http://localhost:3000/logs';\nconst urlUsers = 'http://localhost:3000/users';\n\nclass LogsWorkspace extends React.Component {\n    constructor(props) {\n        super(props);\n        this.setPeriod = this.setPeriod.bind(this);\n        this.state = {\n            rows: [],\n            changedRows: [],\n            users: [],\n            loading: false,\n            settingPeriod: moment(new Date()).format('MM.YYYY')\n        };\n    }\n\n    componentWillMount() {\n        this.loadData(this.state.settingPeriod);\n    }\n\n    loadData(period) {\n        fetch(urlLogs + '?period=' + period)\n            .then(function(responseLogs) {\n                console.log(responseLogs);\n                return responseLogs.json();\n            })\n            .then(resultLogs => {\n                fetch(urlUsers)\n                    .then(function(responseUsers) {\n                        console.log(responseUsers);\n                        return responseUsers.json();\n                    })\n                .then(resultUsers => this.parseData(resultUsers, resultLogs, period))\n                .catch(e => console.log(e));\n            })\n            .catch(e => console.log(e));\n    }\n\n    parseData(users, logs, period) {\n        this.setState({\n            rows: logs,\n            changedRows: logs,\n            users: users,\n            settingPeriod: period,\n            loading: true\n        });\n    }\n\n    findRows = (foundRows) => {\n        this.setState({\n            changedRows: foundRows\n        });\n    };\n\n    setPeriod(event) {\n        this.setState({\n            loading: false\n        });\n        let newPeriod = event.target.value;\n        this.loadData(newPeriod);\n    }\n\n    addRow = (newLogsData) => {\n        let allLogsData = this.state.rows;\n\n        allLogsData.push(newLogsData);\n\n        dataAdd(urlLogs, newLogsData).then(logs => {\n            this.setState({\n                rows: allLogsData,\n                changedRows: allLogsData\n            });\n        }).catch(function(logs) {\n            console.log('error ' + logs);\n        })\n    };\n\n    removeRow = (i) => {\n        let allLogsData = this.state.rows;\n        let deleteId = allLogsData[i].id;\n        \n        allLogsData.splice(i, 1);\n        \n        dataDelete(urlLogs, deleteId).then(logs => {\n            this.setState({\n                rows: allLogsData,\n                changedRows: allLogsData\n            });\n        }).catch(function(logs) {\n            console.log('error ' + logs);\n        })\n    };\n\n    updateRow = (id, userId, time, date, name, company, pages, long, logItems) => {\n        let allLogsData = this.state.rows;\n\n        let updateLogData = {\n            id: id,\n            userId: userId,\n            time: time,\n            date: date,\n            period: date.slice(3,10),\n            name: name,\n            company: company,\n            pages: pages,\n            long: long,\n            logItems: logItems\n        };\n\n        for (let i = 0; i < allLogsData.length; i++) {\n            if (allLogsData[i].id === id) {\n                allLogsData[i] = updateLogData;\n            }\n        }\n\n        dataUpdate(urlLogs, updateLogData, updateLogData.id).then(logs => {\n            this.setState({\n                rows: allLogsData,\n                changedRows: allLogsData\n            });\n        }).catch(function(logs) {\n            console.log('error ' + logs);\n        })\n\n    };\n\n    render() {\n        return (\n            <div className=\"logs\">\n                {(!this.state.loading) ? <Loader /> : null}\n                <Userbar>\n                    <FindLogs presentRows={this.state.rows} find={this.findRows} />\n                    <select className=\"userbar__period\" onChange={this.setPeriod} defaultValue={this.state.settingPeriod}>\n                        <option value=\"11.2019\">Ноябрь 2019</option>\n                        <option value=\"10.2019\">Октябрь 2019</option>\n                        <option value=\"09.2019\">Сентябрь 2019</option>\n                        <option value=\"08.2019\">Август 2019</option>\n                        <option value=\"07.2019\">Июль 2019</option>\n                        <option value=\"06.2019\">Июнь 2019</option>\n                        <option value=\"05.2019\">Май 2019</option>\n                        <option value=\"04.2019\">Апрель 2019</option>\n                        <option value=\"03.2019\">Март 2019</option>\n                        <option value=\"02.2019\">Февраль 2019</option>\n                        <option value=\"01.2019\">Январь 2019</option>\n                        <option value=\"12.2018\">Декабрь 2018</option>\n                        <option value=\"11.2018\">Ноябрь 2018</option>\n                    </select>\n                </Userbar>\n                <div className=\"logs__addbar\">\n                    <h2 className=\"logs__title\">Панель управления посещениями пользователей</h2>\n                    <AddLogs add={this.addRow} currentLogs={this.state.rows} users={this.state.users}/>\n                </div>\n                <div className=\"logs__data\">\n                    <h2 className=\"logs__title\">Таблица посещений пользователей</h2>\n                    <LogsTable\n                        rows={this.state.changedRows}\n                        removeRow={this.removeRow}\n                        updateRow={this.updateRow}\n                    />\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default LogsWorkspace;\n"]},"metadata":{},"sourceType":"module"}
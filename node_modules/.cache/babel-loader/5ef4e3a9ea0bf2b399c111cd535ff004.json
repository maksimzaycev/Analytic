{"ast":null,"code":"import _classCallCheck from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/maksimzajcev/Desktop/Work/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/maksimzajcev/Desktop/Work/src/components/React.user.js\";\nimport React, { Component } from 'react';\nimport dataLoad from '../models/dataLoad';\nimport Navigation from './React.nav';\nimport Loader from './React.loader';\nimport moment from 'moment';\nimport UserWorkspace from './React.user.workspace';\nimport '../css/main.css';\n\nvar User =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(User, _Component);\n\n  function User(props) {\n    var _this;\n\n    _classCallCheck(this, User);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(User).call(this, props));\n    _this.state = {\n      userName: '',\n      userUnit: '',\n      userCompany: '',\n      userLogs: [],\n      systemObjects: [],\n      chartVisits: [],\n      chartViews: [],\n      startDate: '',\n      finishDate: '',\n      loading: false\n    };\n    return _this;\n  }\n\n  _createClass(User, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.loadData();\n    }\n  }, {\n    key: \"loadData\",\n    value: function loadData() {\n      var _this2 = this;\n\n      var urlUsers = 'http://localhost:3000/users';\n      var urlLogs = 'http://localhost:3000/logs';\n      var userId = parseInt(this.props.match.params.userId);\n      var urlUser = urlUsers + '/' + userId;\n      var usersLogs;\n      dataLoad(urlLogs).then(function (logs) {\n        usersLogs = JSON.parse(logs);\n\n        var userLogs = _this2.selectUserLogs(userId, usersLogs);\n\n        var chartVisits = _this2.sortVisitsChart(userLogs);\n\n        var chartViews = _this2.sortViewsChart(userLogs);\n\n        var finishDate = moment(new Date(), 'DD.MM').subtract(1, \"days\");\n        var startDate = moment(new Date(), 'DD.MM').subtract(30, \"days\");\n        dataLoad(urlUser).then(function (users) {\n          var user = JSON.parse(users);\n\n          _this2.setState({\n            userName: user.name,\n            userUnit: user.unit,\n            userCompany: user.company,\n            userLogs: userLogs,\n            chartVisits: chartVisits,\n            chartViews: chartViews,\n            startDate: startDate.format('DD.MM'),\n            finishDate: finishDate.format('DD.MM'),\n            loading: true\n          });\n        }).catch(function (users) {\n          console.log('error ' + users);\n        });\n      }).catch(function (logs) {\n        console.log('error ' + logs);\n      });\n    }\n  }, {\n    key: \"sortVisitsChart\",\n    value: function sortVisitsChart(userLogs) {\n      var currentlyDate = moment(new Date(), 'DD.MM');\n      var startDate = currentlyDate.subtract(30, \"days\");\n      var sortVisits = [];\n\n      for (var i = 30; i > 0; i--) {\n        var visitsOnDay = 0;\n\n        for (var j = 0; j < userLogs.length; j++) {\n          if (userLogs[j].time.slice(0, 5) === startDate.format('DD.MM')) {\n            visitsOnDay++;\n          }\n        }\n\n        var oneDayValue = {\n          x: startDate.format('DD.MM'),\n          y: visitsOnDay\n        };\n        startDate = startDate.add(1, \"days\");\n        sortVisits.push(oneDayValue);\n      }\n\n      return sortVisits;\n    }\n  }, {\n    key: \"sortViewsChart\",\n    value: function sortViewsChart(userLogs) {\n      var currentlyDate = moment(new Date(), 'DD.MM');\n      var startDate = currentlyDate.subtract(30, \"days\");\n      var sortViews = [];\n\n      for (var i = 30; i > 0; i--) {\n        var viewsOnDay = 0;\n\n        for (var j = 0; j < userLogs.length; j++) {\n          if (userLogs[j].time.slice(0, 5) === startDate.format('DD.MM')) {\n            viewsOnDay = viewsOnDay + userLogs[j].pages;\n          }\n        }\n\n        var oneDayValue = {\n          x: startDate.format('DD.MM'),\n          y: viewsOnDay\n        };\n        startDate = startDate.add(1, \"days\");\n        sortViews.push(oneDayValue);\n      }\n\n      return sortViews;\n    }\n  }, {\n    key: \"selectUserLogs\",\n    value: function selectUserLogs(userId, allLogs) {\n      var userVisits = [];\n\n      for (var i = 0; i < allLogs.length; i++) {\n        if (allLogs[i].userId === userId) {\n          userVisits.push(allLogs[i]);\n        }\n      }\n\n      return userVisits;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        id: \"maskComponent\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133\n        },\n        __self: this\n      }, !this.state.loading ? React.createElement(Loader, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      }) : null, React.createElement(\"div\", {\n        id: \"sidebar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 135\n        },\n        __self: this\n      }, React.createElement(Navigation, {\n        activeItem: this.props.activeItem,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        className: \"panel\",\n        id: \"panel\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, React.createElement(UserWorkspace, {\n        userName: this.state.userName,\n        userUnit: this.state.userUnit,\n        userCompany: this.state.userCompany,\n        userLogs: this.state.userLogs,\n        chartVisits: this.state.chartVisits,\n        chartViews: this.state.chartViews,\n        startDate: this.state.startDate,\n        finishDate: this.state.finishDate,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return User;\n}(Component);\n\nexport default User;","map":{"version":3,"sources":["/Users/maksimzajcev/Desktop/Work/src/components/React.user.js"],"names":["React","Component","dataLoad","Navigation","Loader","moment","UserWorkspace","User","props","state","userName","userUnit","userCompany","userLogs","systemObjects","chartVisits","chartViews","startDate","finishDate","loading","loadData","urlUsers","urlLogs","userId","parseInt","match","params","urlUser","usersLogs","then","logs","JSON","parse","selectUserLogs","sortVisitsChart","sortViewsChart","Date","subtract","users","user","setState","name","unit","company","format","catch","console","log","currentlyDate","sortVisits","i","visitsOnDay","j","length","time","slice","oneDayValue","x","y","add","push","sortViews","viewsOnDay","pages","allLogs","userVisits","activeItem"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport dataLoad from '../models/dataLoad';\nimport Navigation from './React.nav';\nimport Loader from './React.loader';\nimport moment from 'moment'\nimport UserWorkspace from './React.user.workspace';\nimport '../css/main.css';\n\nclass User extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            userName: '',\n            userUnit: '',\n            userCompany: '',\n            userLogs: [],\n            systemObjects: [],\n            chartVisits: [],\n            chartViews: [],\n            startDate: '',\n            finishDate: '',\n            loading: false\n        };\n    }\n\n    componentWillMount() {\n        this.loadData();\n    }\n\n    loadData() {\n        var urlUsers = 'http://localhost:3000/users';\n        var urlLogs = 'http://localhost:3000/logs';\n        var userId = parseInt(this.props.match.params.userId);\n        var urlUser = urlUsers + '/' + userId;\n\n        var usersLogs;\n        \n        dataLoad(urlLogs).then(logs => {\n            usersLogs = JSON.parse(logs);\n\n            var userLogs = this.selectUserLogs(userId,usersLogs);\n            var chartVisits = this.sortVisitsChart(userLogs);\n            var chartViews = this.sortViewsChart(userLogs);\n\n            var finishDate = moment(new Date(), 'DD.MM').subtract(1, \"days\");\n            var startDate = moment(new Date(), 'DD.MM').subtract(30, \"days\");\n\n            dataLoad(urlUser).then(users => {\n                var user = JSON.parse(users);\n                this.setState({\n                    userName: user.name,\n                    userUnit: user.unit,\n                    userCompany: user.company,\n                    userLogs: userLogs,\n                    chartVisits: chartVisits,\n                    chartViews: chartViews,\n                    startDate: startDate.format('DD.MM'),\n                    finishDate: finishDate.format('DD.MM'),\n                    loading: true\n                });\n            }).catch(function(users) {\n                console.log('error ' + users);\n            })\n\n        }).catch(function(logs) {\n            console.log('error ' + logs);\n        })\n    }\n\n    sortVisitsChart(userLogs) {\n        var currentlyDate = moment(new Date(), 'DD.MM');\n        var startDate = currentlyDate.subtract(30, \"days\");\n        var sortVisits = [];\n\n        for (let i = 30; i > 0; i--) {\n            var visitsOnDay = 0;\n            for (let j = 0; j < userLogs.length; j++) {\n                if (userLogs[j].time.slice(0, 5) === startDate.format('DD.MM')) {\n                    visitsOnDay++;\n                }\n            }\n\n            var oneDayValue = {\n                x: startDate.format('DD.MM'),\n                y: visitsOnDay\n            };\n\n            startDate = startDate.add(1, \"days\");\n            sortVisits.push(oneDayValue);\n        }\n\n        return sortVisits;\n    }\n\n    sortViewsChart(userLogs) {\n        var currentlyDate = moment(new Date(), 'DD.MM');\n        var startDate = currentlyDate.subtract(30, \"days\");\n        var sortViews = [];\n\n        for (let i = 30; i > 0; i--) {\n            var viewsOnDay = 0;\n            for (let j = 0; j < userLogs.length; j++) {\n                if (userLogs[j].time.slice(0, 5) === startDate.format('DD.MM')) {\n                    viewsOnDay = viewsOnDay + userLogs[j].pages;\n                }\n            }\n\n            var oneDayValue = {\n                x: startDate.format('DD.MM'),\n                y: viewsOnDay\n            };\n\n            startDate = startDate.add(1, \"days\");\n            sortViews.push(oneDayValue);\n        }\n\n        return sortViews;\n    }\n\n    selectUserLogs(userId, allLogs) {\n        var userVisits = [];\n        for (let i = 0; i < allLogs.length; i++) {\n            if (allLogs[i].userId === userId) {\n                userVisits.push(allLogs[i]);\n            }    \n        }\n\n        return userVisits;\n    }\n\n    render() {\n        return (\n            <div id=\"maskComponent\">\n                {!this.state.loading ? <Loader /> : null}\n                <div id=\"sidebar\">\n                    <Navigation activeItem={this.props.activeItem}/>\n                </div>\n                <div className=\"panel\" id=\"panel\">\n                    <UserWorkspace\n                        userName={this.state.userName}\n                        userUnit={this.state.userUnit}\n                        userCompany={this.state.userCompany}\n                        userLogs={this.state.userLogs}\n                        chartVisits={this.state.chartVisits}\n                        chartViews={this.state.chartViews}\n                        startDate={this.state.startDate}\n                        finishDate={this.state.finishDate}\n                    />\n                </div>                        \n            </div>\n        );\n    }\n}\n\nexport default User;\n\n"]},"metadata":{},"sourceType":"module"}